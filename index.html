<head>
  <title>
    easychesslogpage
  </title>
</head>
easychess log page
<script>
  let maxstar = ""
  function isnewinner(date){
    let elapsed = new Date().getTime() - new Date(date).getTime()
    if(elapsed < 10 * 60 * 1000) return `<span style="color:#070;font-weight:bold"> *** just now !!!</span>`
    if(elapsed < 60 * 60 * 1000) return `<span style="color:#007;font-weight:bold"> ** within in one hour</span>`
    if(elapsed < 3 * 60 * 60 * 1000) return `<span style="color:#700;font-weight:bold"> * within three hours</span>`
    if(elapsed < 6 * 60 * 60 * 1000) return `<span style="color:#999;font-style:italic"> within six hours</span>`
    if(elapsed < 12 * 60 * 60 * 1000) return `<span style="color:#bbb;font-style:italic">in half a day</span>`
    if(elapsed < 24 * 60 * 60 * 1000) return `<span style="color:#ddd;font-style:italic">in a day</span>`
    return ""
  }
  function isnew(date){
    let instr = isnewinner(date)
    let stars = instr.match(/(\*+)/)
    if(stars){
      let starsstr = stars[1]
      if(starsstr.length > maxstar.length) maxstar = starsstr
    }
    return instr
  }
  fetch(`https://api.github.com/repos/easychessanimations/botlogin/commits`).then(response=>response.text().then(content=>
    {
      document.write(`<head><style>.tabl {background-color:#ffe;}</style></head><body>${new Date().toUTCString()}<hr><div style="height: 160px;overflow-y:scroll;"><table class="tabl" cellpadding="1" cellspacing="3">`)
      document.body.style.fontFamily = "monospace"
      JSON.parse(content).map((item,i)=>
        document.write(`<tr><td>${i+1}</td><td>${item.commit.message}</td><td>${item.commit.author.date}</td><td>&nbsp;<a href="https://lichess.org/@/${item.commit.message.split(" ")[0]}" rel="noopener noreferrer" target="_blamk">open</a></td><td>${isnew(item.commit.author.date)}</td></tr>`)
      )
      document.write(`</table></div>`)
    
      fetch(`https://api.github.com/repos/easychessanimations/botgame/commits`).then(response=>response.text().then(content=>
      {
        document.write(`<hr><div style="height: 160px;overflow-y:scroll;"><table class="tabl" cellpadding="1" cellspacing="3">`)
        JSON.parse(content).map((item,i)=>{
          document.write(`<tr><td>${i+1}</td><td>${item.commit.message}</td><td id="game${i}" style="width: 200px;"><td id="result${i}" style="width: 50px;"></td><td>${item.commit.author.date}</td><td>&nbsp;<a href="https://lichess.org/${item.commit.message.split(" ")[2]}" rel="noopener noreferrer" target="_blamk">open</a></td><td>${isnew(item.commit.author.date)}</td></tr>`)
          
          fetch(`https://raw.githubusercontent.com/easychessanimations/botgame/${item.sha}/${item.commit.message}`).then(response=>response.text().then(content=>
            {
              let blob = JSON.parse(content)
              let clock = blob.clock ? `${blob.clock.initial/60000} + ${blob.clock.increment/1000}` : "infinite"
              document.getElementById(`game${i}`).innerHTML = `${clock} ${blob.rated ? "rated" : "casual"}`
            }
          ))
          
          fetch(`https://lichess.org/game/export/${item.commit.message.split(" ")[2]}`, {headers:{Accept: "application/json"}}).then(response=>response.text().then(content=>
            {
              let blob = JSON.parse(content)
              let plies = blob.moves ? blob.moves.split(" ").length : 0
              document.getElementById(`result${i}`).innerHTML = `${plies < 2 ? "abort" : plies}`
            }                                                                                                              
          ))
        })
          
        document.write(`</table></div>`)
        
        document.title=`easychesslogpage ${maxstar}`
        
        fetch(`https://api.github.com/repos/easychessanimations/logtab/commits`).then(response=>response.text().then(content=>
        {
          document.write(`<hr><div style="height: 160px;overflow-y:scroll;"><table class="tabl" cellpadding="1" cellspacing="3">`)
          JSON.parse(content).map((item,i)=>{
            document.write(`<tr><td>${i+1}</td><td>${item.commit.message}</td><td>${item.commit.author.date}</td></tr>`)            
          })
          document.write(`</table></div>`)

          fetch(`https://api.github.com/repos/easychessanimations/logmove/commits`).then(response=>response.text().then(content=>
          {
            document.write(`<hr><div style="height: 80px;overflow-y:scroll;"><table class="tabl" cellpadding="1" cellspacing="3">`)
            JSON.parse(content).map((item,i)=>{
              document.write(`<tr><td>${i+1}</td><td>${item.commit.message}</td><td>${item.commit.author.date}</td></tr>`)            
            })
            document.write(`</table></div></body>`)
          }))
        }))
      }))
    }
  ))
  
  setTimeout(_=>document.location.reload(), 3 * 60000)
</script>
